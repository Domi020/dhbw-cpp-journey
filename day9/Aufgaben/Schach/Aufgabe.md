#Aufgabe
Schreibe einen einfachen Schachcomputer, der über einen Zuggenerator, eine Minimax Suche und eine Bewertungsfunktion, den nächsten Spielzug des schwarzen Spielers (Computergegner) berechnet. Dabei soll die gewünschte Tiefe des betrachteten Baums über die Kommandozeile angegeben werden können. Die Figurenwerte können dabei von den Studierenden selbst gepflegt und festgelegt werden. Als Sondersituationen müssen lediglich Schach und Matt betrachtet werden, die Rochhade entfällt.

*Fokus:* Soll hierbei nicht auf einen möglichst komplexen und siegreichen Schachcomputer gelegt werden, sondern auf die Nutzung der erlernten Programmierpatterns.

*Bonus:* Zusätzlich zur Baumtiefe wird die Ruhesuche implementiert

#Schachprogramme und ihre Funktionsweise
Die grundlegenden Komponenten eines Schachprogramms sind Zuggenerator und Bewertungsfunktion. Mit Hilfe des Zuggenerators wird der Spielbaum generiert. Die Bewertungsfunktion bewertet die Spielstellungen an den Blättern des Baumes. Durch die Minimax-Suche (siehe unten) wird dann der beste Zug ermittelt.
Das hier vorgestellte Basisdesign stammt von Claude Shannon. Er hat in den 70er Jahren ein Programm namens „Chess 4.5“ herausgebracht, welches als erstes den hier vorgestellten Ansatz implementiert hatte.
##1 Zuggenerator
Der Zuggenerator ist erstmal eine einfache Funktion, die ein Spielbrett übergeben bekommt und die dann alle legalen Züge für eine bestimmte Farbe ermittelt und diese möglichen Figurbewegungen - die potentiellen Züge - ausgibt. Indem sich der Zuggenerator selbst rekursiv aufruft, kann er einen Spielbaum bis zu einer bestimmten Tiefe erzeugen. Das rekursive Aufrufen geschieht wechselnd. Wurde der Zuggenerator für weiß aufgerufen, ruft er sich in der nächsten Instanz für schwarz auf und umgekehrt. Die Tiefe des Spielbaums wird mit der Anzahl der "Halbzüge" (plies) angegeben. Wenn das Schachprogramm seine eigenen möglichen Züge mit den möglichen Zügen des Gegners durchrechnet, ergibt das zwei Halbzüge. Abbildung 1 zeigt den rekursiven Aufruf des Zuggenerators für zwei Halbzüge. Die Graphik ist vereinfacht. Jeder Spieler hat nur zwei Möglichkeiten. Im Schach gibt es meistens weit mehr Zugoptionen. Die Ausgangssituation im Schach bringt 20 Zugmöglichkeiten. Bei 2 Halbzügen ergibt das schon 400 Möglichkeiten. Die Anzahl der möglichen Halbzüge steigt mit der Suchtiefe exponentiell an ("kombinatorische Explosion"). An den Blättern des Spielbaums wird das resultierende Spielbrett der Bewertungsfunktion übergeben. Die Bewertungsfunktion gibt an, ob die Stellung (das Spielbrett) für eine bestimmte Partei "gut" oder "schlecht" ist. Die Bewertungsfunktion gibt für eine Spielsituation einen Wert aus. Ist er positiv, ist weiß im Vorteil, ist er negativ, ist schwarz im Vorteil. Mit den Werten der Bewertungsfunktion kann man mit der so genannten Minimax-Suche einen Zug berechnen.
##2 Minimax-Suche
Die Minimax-Suche beruht auf dem Prinzip, dass jeder Spieler seinen „bestmöglichen“ Zug spielen würde. Für den weißen Spieler bedeutet „bester Zug“, dass von den zur Option stehenden Zügen, der Zug ausgewählt wird, der maximal positiv ist. Für den schwarzen Spieler bedeutet es, dass der maximal negative Zug gewählt wird (siehe Bewertungsfunktion).  Es werden hier wieder zwei Halbzüge des Spielbaums verarbeitet. Weiß ist am Zug und hat am Anfang die Auswahl unter drei möglichen Zügen. Rekursiv wird dann der Spielbaum bis zur Suchtiefe zwei durchgearbeitet. An den Blattknoten werden die resultierenden Stellungen bewertet. Es wird jetzt immer abwechselnd pro Rekursionstiefe minimiert oder maximiert. Das bedeutet, dass die Elternknoten den niedrigsten bzw. höchsten Wert der Kindknoten übernehmen. In der Abbildung werden die Blattknoten in der untersten Ebene minimiert und in der nächsthöheren Ebene maximiert. Somit wurde der bestmögliche Spielzug von den drei zur Auswahl stehenden Zügen für den weißen Spieler ermittelt. Es ist der mittlere Spielzug, den das Programm dann auch spielen würde. Hätte man einen Zug für den schwarzen Spieler berechnen wollen, wäre das gleiche Prinzip zur Anwendung gekommen, mit dem Unterschied, dass am Anfang (oberste Ebene) minimiert statt maximiert werden würde.


##3 Bewertungsfunktion
Wie oben erwähnt ist die Bewertungsfunktion eine Funktion, die ein Spielbrett (mit einer beliebigen Spielsituation) übergeben bekommt und eine Bewertungszahl zurückliefert.
Die Grundidee der Bewertungsfunktion ist die, dass sie einen von drei Werten zurückgibt. „1“ für „Weiß gewinnt“, „-1“ für „Schwarz gewinnt“ und „0“ für unentschieden. Das setzt aber voraus, dass die Bewertungsfunktion nur Stellungen am Ende des Spielbaums bewertet, dass sie also nur Situationen zur Bewertung bekommt, an denen das Spiel zu Ende ist. Dies lässt sich zwar in endlicher Zeit berechnen, aber die Zeit die man dafür bräuchte ist astronomisch groß. Die Bewertungsfunktion muss also auch Stellungen bewerten können, bei denen das Spiel noch nicht zu Ende ist.
Das kann man nur mit Heuristiken1 erreichen. So wird versucht zu ermitteln, mit welcher ungefähren Wahrscheinlichkeit die Stellung für einen Spieler besser oder schlechter ist, bzw. mit welcher Wahrscheinlichkeit ein Spieler gewinnt.
Die einfachste heuristische Bewertungsfunktion für Schachprogramme besteht im Aufsummieren der Figuren, die sich auf dem Spielfeld befinden, also die reinen Materialwerte. Die Figuren haben unterschiedliche Werte. Die Dame hat natürlich einen höheren Wert als ein Bauer. Die schwarzen Figuren erhalten negative Werte, die weißen Figuren erhalten positive Werte. Wenn schwarz und weiß die gleichen Figuren in der gleichen Anzahl haben, ergibt die Summe null. Nach der Bewertungsfunktion bedeutet das, dass diese Spielsituation ausgewogen, also unentschieden ist. Die Bewertungsfunktion wird einen positiven Wert übergeben, wenn weiß im materiellen Vorteil ist, wobei die Zahl aussagt, wie stark das der Fall ist. Negative Werte bedeuten einen Vorteil für schwarz. Die Bewertungsfunktion erkennt natürlich auch, ob ein König im Schach steht, wenn das Spiel unentschieden ist oder ein König matt ist. Für das Schachsetzen gibt es einen Bonus bzw. eine Strafe. Für das Mattsetzen gibt es einen sehr hohen Bonus bzw. eine sehr hohe Strafe. Der Bonus bzw. die Strafe sollte so hoch sein, dass der Materialwert dagegen unbedeutend ist, weil Mattzüge natürlich in jedem Fall gesetzt werden sollen (aus der Sicht des Mattsetzers), bzw. in jedem Fall verhindert werden sollen (aus der Sicht des Mattgesetzten).
Man erkennt gleich, wie einfach dieses Verfahren ist, weil die Positionen auf dem Spielfeld und der Figuren zueinander unberücksichtigt bleiben. Hier setzen dann komplexere Bewertungsfunktionen an, die eine Vielzahl von Heuristiken enthalten, wann eine Situation für eine Partei von Vorteil ist. Diese Situationen gehen mit "Bonuspunkten" in die Bewertung mit ein. Die Programmierer der Schachprogramme lassen sich dabei unter anderem von Schachgroßmeistern beraten. Trotzdem könnte ein Schachprogramm mit der beschriebenen einfachen Stellungsbewertung, vorausgesetzt man hätte die entsprechende Rechenleistung, ein perfektes Spiel
1 "Heuristik: Algorithmen zur Lösung komplexer Probleme verbessert man häufig durch Strategien, die oft auf Hypothesen und Vermutungen aufbauen und die mit höherer Wahrscheinlichkeit (jedoch ohne Garantie) das Auffinden einer Lösung beschleunigen sollen. Solche Strategien heißen Heuristiken. Faustregeln, bereits früher beobachtete Eigenschaften von Lösungen oder die Nachbildung des menschlichen Problemlösungsprozesses sind typische Heuristiken." Definition aus dem Informatikduden
spielen. Zum Durchrechnen des gesamten Spielbaums ist die Komplexität des Spiels aber zu hoch, zumindest in der Anfangsphase des Spiels.
## Ruhesuche
Ruhesuche heißt, dass nicht nur bis zur vorgegebenen Suchtiefe gerechnet wird. Der Spielbaum wird dabei unter bestimmten Umständen von einem Blatt aus weiter verfolgt. Dies geschieht zum Beispiel, wenn eine Figur gerade geschlagen wurde. Das kann eventuell einen Vorteil oder einen Nachteil bedeuten, der nicht gerechtfertigt ist, weil in der nächsten Runde ein „Gegenschlag“ die Situation wieder ausgleichen könnte.
Zum Beispiel schlägt die Dame in einem Blatt des Spielbaums einen Läufer. Das bringt erst einmal einen Vorteil. Doch in der nächsten Runde könnte diese Dame durch einen Bauern geschlagen werden, was sich dann in einen gravierenden Nachteil verwandelt würde. Deshalb wird die Berechnung an dieser Stelle soweit vertieft, bis sich die Spielsituation „beruhigt“ hat und es zu keinem Schlagabtausch mehr kommt. Der Zuggenerator kann dabei auch unterstützen, indem er die Schlagzüge mit einer Zusatzinformation über den Zug markiert und die Bewertungsfunktion dies nicht selbst „herausfinden“ muss.
Generell wird das Spiel auch in verschiedene Phasen eingeteilt. Im Endspiel befinden sich weniger Figuren auf dem Spielfeld und die Berechnung ist weniger komplex. Deshalb kann in gleicher Zeit tiefer gerechnet werden, was dann auch gemacht wird. Allgemein wird die Suchtiefe dynamisch variiert, um sich den verschiedenen Zuständen des Spiels anzupassen.